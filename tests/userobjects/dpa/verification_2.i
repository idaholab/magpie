#
# 1 / E spectrum, sigma(E) = 1 / (1 + sqrt(E))
# K-P model, C-12 atoms, Ed = 30 eV, Emin = 1e-5, Emax = 1e6 eV
#
# correct answer: 4.701
# answer ng = 63: 4.76
#        ng = 25; 4.93
#        ng = 7 ; 8.17
#
#  ng   error   order
#   7   3.469
#  25   0.23    2.13
#  63   0.06    1.45
#
Ed = 30

[Mesh]
  type = GeneratedMesh
  dim = 1
  xmin = 0
  xmax = 1
  nx = 2
[]

[Problem]
  type = FEProblem
  kernel_coverage_check = false
[]

[Variables]
  [test_var]
  []
[]

[Functions]
  [KP]
    type = ParsedFunction
    expression = 't / 2 / ${Ed}'
  []
[]

[UserObjects]
  [KPtest]
    type = FunctionDPAUserObject
    damage_reaction_types = 'elastic'
    damage_functions = 'KP'
    irradiation_time = 1
    Z = '6'
    A = '12'
    number_densities = '1'
    scalar_flux = '2.30258509  2.30258509  2.30258509  2.30258509  2.30258509  2.30258509 11.51292546'
    ## more refined scalar fluxes:
    #value = ' 0.22314355  0.47000363  0.22314355  0.47000363  0.91629073  0.22314355
    #          0.47000363  0.22314355  0.47000363  0.91629073  0.22314355  0.47000363
    #          0.22314355  0.47000363  0.91629073  0.69314718  1.60943791  0.22314355
    #          0.47000363  1.60943791  0.69314718  1.60943791  0.69314718  0.69314718
    #         10.1266311'
    #value = '1.00503359e-02 1.52674721e-02 2.59754864e-02 2.66682471e-02
    #         2.73989742e-02 2.81708770e-02 2.89875369e-02 2.98529631e-02
    #         3.07716587e-02 3.17486983e-02 3.27898228e-02 3.39015517e-02
    #         3.50913198e-02 3.63676442e-02 3.77403280e-02 3.92207132e-02
    #         4.08219945e-02 8.70113770e-02 9.53101798e-02 5.12932944e-02
    #         5.40672213e-02 5.71584138e-02 6.06246218e-02 6.45385211e-02
    #         6.89928715e-02 7.41079722e-02 8.00427077e-02 8.70113770e-02
    #         9.53101798e-02 1.05360516e-01 1.17783036e-01 1.33531393e-01
    #         1.54150680e-01 1.82321557e-01 2.23143551e-01 1.05360516e-01
    #         1.17783036e-01 1.33531393e-01 1.54150680e-01 1.82321557e-01
    #         2.23143551e-01 2.87682072e-01 4.05465108e-01 6.93147181e-01
    #         1.05360516e-01 1.17783036e-01 1.33531393e-01 1.54150680e-01
    #         1.82321557e-01 2.23143551e-01 2.87682072e-01 4.05465108e-01
    #         6.93147181e-01 6.93147181e-01 1.60943791e+00 2.23143551e-01
    #         4.70003629e-01 1.60943791e+00 6.93147181e-01 1.60943791e+00
    #         6.93147181e-01 6.93147181e-01 1.01266311e+01'

    energy_group_boundaries = '1.e+06 1.e+05 1.e+04 1.e+03 1.e+02 1.e+01 1.e+00 1.e-05'
    ## more refined energy group boundaries
    #value = '1.0e+06 8.0e+05 5.0e+05 4.0e+05 2.5e+05 1.0e+05 8.0e+04 5.0e+04 4.0e+04
    #         2.5e+04 1.0e+04 8.0e+03 5.0e+03 4.0e+03 2.5e+03 1.0e+03 5.0e+02 1.0e+02
    #         8.0e+01 5.0e+01 1.0e+01 5.0e+00 1.0e+00 5.0e-01 2.5e-01 1.0e-05'
    #value = '1.00e+06 9.90e+05 9.75e+05 9.50e+05 9.25e+05 9.00e+05 8.75e+05 8.50e+05
    #         8.25e+05 8.00e+05 7.75e+05 7.50e+05 7.25e+05 7.00e+05 6.75e+05 6.50e+05
    #         6.25e+05 6.00e+05 5.50e+05 5.00e+05 4.75e+05 4.50e+05 4.25e+05 4.00e+05
    #         3.75e+05 3.50e+05 3.25e+05 3.00e+05 2.75e+05 2.50e+05 2.25e+05 2.00e+05
    #         1.75e+05 1.50e+05 1.25e+05 1.00e+05 9.00e+04 8.00e+04 7.00e+04 6.00e+04
    #         5.00e+04 4.00e+04 3.00e+04 2.00e+04 1.00e+04 9.00e+03 8.00e+03 7.00e+03
    #         6.00e+03 5.00e+03 4.00e+03 3.00e+03 2.00e+03 1.00e+03 5.00e+02 1.00e+02
    #         8.00e+01 5.00e+01 1.00e+01 5.00e+00 1.00e+00 5.00e-01 2.50e-01 1.00e-05'

    cross_section = '0.00187423 0.00590036 0.0183991  0.05574353 0.15587673 0.3633979 0.88013648'
    ## more refined cross sections
    #value = '0.0010568  0.00125874 0.00149389 0.00177919 0.00253039 0.00333427
    #         0.00396962 0.00470886 0.00560463 0.0079575  0.01046834 0.01244572
    #         0.01474048 0.01751023 0.02473112 0.03640536 0.06407202 0.09566219
    #         0.11187534 0.17707499 0.27373741 0.40201256 0.54310661 0.6268184
    #         0.92054459'
    #value = '0.00100151 0.00100787 0.00101831 0.00103178 0.00104581 0.00106043
    #         0.00107567 0.00109159 0.00110825 0.00112569 0.00114398 0.00116319
    #         0.0011834  0.00120471 0.00122721 0.00125102 0.00127628 0.00131775
    #         0.00137914 0.00143046 0.00146858 0.00150993 0.00155499 0.00160435
    #         0.00165873 0.00171905 0.00178649 0.00186256 0.00194929 0.00204941
    #         0.00216679 0.00230707 0.00247883 0.00269604 0.00298331 0.00323654
    #         0.00342169 0.00364291 0.00391373 0.00425614 0.00470886 0.00534867
    #         0.00635954 0.00837959 0.0101637  0.01074084 0.01142982 0.01227241
    #         0.0133363  0.01474048 0.01672028 0.01983693 0.02602255 0.03640536
    #         0.06407202 0.09566219 0.11187534 0.17707499 0.27373741 0.40201256
    #         0.54310661 0.6268184  0.92054459'
  []
[]

[Postprocessors]
  [dpa]
    type = DPAPostprocessor
    dpa_object = KPtest
  []
[]

[Executioner]
  type = Steady
[]

[Outputs]
  csv = true
[]
